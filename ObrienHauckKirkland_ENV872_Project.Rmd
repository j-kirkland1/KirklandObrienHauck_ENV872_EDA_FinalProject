---
title: Spatial, Temporal, and Depth Distributions of Mercury Contamination in the
  Penobscot River, Maine
author: "Sloane Hauck, Julia Kirkland, Meg O'Brien, and Cira Ortiz"
output:
  html_document:
    df_print: paged
  pdf_document: default
toc: true
lof: true
lot: true
geometry: margin=2.54cm
editor_options:
  chunk_output_type: console
---
\listoftables 
```{r project.setup, error=FALSE, message=FALSE, warning=FALSE, include=FALSE, results='hide'}
packages <- c("tidyverse", "readxl", "dplyr", "lubridate", "sp", "sf","mapview",
              "knitr", "here", "ggplot2", "zoo", "trend")

check.packages <- function(pkg){
  new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
  if(length(new.pkg))
    install.packages(new.pkg, dependencies = TRUE)
  sapply(pkg, require, character.only = TRUE)
}
check.packages(packages)

'%ni%' <- Negate('%in%')


#Add theme here:

Mytheme <- theme_classic (base_size = 14) +
theme(
plot.title = element_text(size = 16, face = 'bold', hjust = 0.5),
axis.text = element_text(color = 'black'),
axis.title.x = element_text(hjust = 0.5, vjust = 2, size = 14),
axis.title.y = element_text(hjust = 0.5, vjust = 2, angle = 90, size = 14), 
legend.position = 'top', 
legend.title = element_text(face = 'italic'),
plot.background = element_rect(fill = "white"),   
panel.background = element_rect(fill = "lavenderblush"),
panel.grid.major = element_line(color = 'gray90'), 
panel.grid.minor = element_line(color = 'gray95'),
panel.border = element_rect(color = "gray70", fill = NA),
axis.ticks = element_line(color = "black", size = 0.5))

theme_set(Mytheme)

```

## Background

The Penobscot River in Maine has been the object of environmental concern
and focus for years. It is the largest watershed in New England and hosts 
the largest run of Atlantic salmon on the East Coast. Despite its ecological 
importance, the watershed has experienced significant degradation due to high 
levels of mercury contamination by a chemical plant. In 1967, a pharmaceutical 
company, Mallinckrodt began discharging mercury into the river as part of its
production process, leaving 13 tons of Mercury in the river by 1970. 

Mercury is a particularly worrisome and challenging contaminant because it 
does not easily break down. The contamination has had a significant and 
lasting impact on the surrounding ecosystem and nearby communities. The 
state of Maine issued an advisory warning pregnant women against eating 
certain species harvested from the river, and certain lobster and 
crab fisheries have been shut down. 

However, due to the steadfast and tenacious efforts of environmental advocates, 
this story has a silver lining. Senior attorney Nancy Marks from the NRDC 
(the Natural Resources Defense Council) filed a lawsuit in 1998, and after two
decades of litigation, a major legal breakthrough was achieved. In 2022, the 
district attorney of Maine settled the long-running case, requiring Mallinckrodt 
to pay $197 million in remediation for the mercury damage. 

Because this watershed has been the subject of extensive study to document 
the need for remediation, there is considerable data about its sediment history.
NOAA has compiled datasets on sediment, soil, and tissue chemistry from various 
studies of the Penobscot watershed. Using this data, we will examine mercury
levels in the sediment.


## Research Questions and Hypotheses

Enter questions and hypotheses here

Research Questions: 

Question 1. How do mercury contamination levels change over time in the 
sediments in the Penobscot River? 
Question 2. Does mercury contamination increase with depth?

Hypothesis 1: Post closure of the site, we would expect that mercury levels 
in surface sediment will decrease over time and as they get further away from 
the site due to natural attenuation. 

Hypothesis 2: Over time, mercury concentrations have decreased in the 
Penobscot River due to sedimentation in the river.


## Dataset Information

The dataset was generated from NOAA’s DIVER (Data Integration, Visualization, 
Exploration and Reporting) system, which is part of the NOAA Damage Assessment,
Remediation, and Restoration Program (DARRP). The data contains Mercury results
from sediment samples collected in the Penobscot River region in Maine from 
June 1st, 1970 to May 5th, 2021. Data is not available for every month of 
the years provided, likely due to shifting priorities with monitoring or 
project specific challenges.

```{r intro.table.data, echo=FALSE}

#Creates a table summarizing information about the dataset
DatasetInfo <- data.frame(Item = c("Data Source", "Date Range", 
                                   "Number of Records ", "Records with Coordinates"),
                          Value = c("NOAA DIVER", "June 1st, 1970 to May 5th, 2021", 
                                    "28,058", "24,501"))

knitr::kable(DatasetInfo, align = c('l', 'l'))

```

```{r setup.spatial.databases, echo=FALSE}
knitr::opts_chunk$set(eval = FALSE, include = FALSE)
#Create a point layer of the site coordinates (44.740733, -68.825704)
Lat <- 44.740733
Long <- -68.825704
Name <- "Mallinckrodt Site"
Site <- data.frame("Site" = Name, "Longitude" = Long, "Latitude" = Lat) %>% 
  st_as_sf(coords=c("Longitude", "Latitude"), crs=4269)

#Penobscot River shapefile
Penobscot <- st_read(here("./Shapefiles/Penobscot_River.shp")) 
Penobscot_clean <- Penobscot %>% 
  st_transform(crs=4269)

mapview(Penobscot_clean)

```

## Data Exploration

We began by importing the raw NOAA Diver dataset and subsetting it to 
include only the columns relevant to our analysis, including site location, 
depth, depth type, chemical type (mercury), and concentration. Next, we flagged 
all records containing coordinate information and created a new subset 
consisting only of samples with valid coordinates. This subset was then 
converted into a spatial dataset for future mapping and spatial analyses. 

```{r data.exploration, include=FALSE}

#Reading in the dataset
data_raw <- read.csv(here("./Raw Data/DIVER_Penobscot_Mercury_2025_11_18_Samples.csv"))

colnames(data_raw)

#Start by subsetting the data to only include columns of interest
#Then we will flag data that has coordinate information
data_wrangle_1 <- data_raw %>% 
  select(Case_Activity, Site_ID, Study_Name, Area_Description, Matrix_Group,
         Station, Date, Sample_ID, Sample_Upper_Depth, Sample_Lower_Depth,
         Sample_Depth_Unit, Depth_Category, Lab_Replicate, ChemCode, Max_Result_.Raw.,
         Analysis_Result_Unit, Start_Latitude, Start_Longitude) %>% 
  mutate(
    Coordinate_Flag = if_else(!is.na(Start_Longitude), "Y", "N"),
    Date = as.Date(Date))

#Here we create a new subset of the data that only includes records with coordinates
#We also make this version of the dataset spatial for future mapping
data_wrangle_2 <- data_wrangle_1 %>% 
  filter(Coordinate_Flag == "Y") %>% 
  filter(Start_Latitude < 44.74788) %>% #this is making sure that we only have data points downstream of the site
  st_as_sf(coords = c("Start_Longitude", "Start_Latitude"),
           crs = 4269)

glimpse(data_wrangle_2)
summary(data_wrangle_2$Max_Result_.Raw.)
#from the summary we see that some results are -9, this is NOAAs method of listing
#denoting that no data is available, so we should exclude it

unique(data_wrangle_2$Analysis_Result_Unit)
#we also see that there are two units, PPM and mg/L. Upon further investigation,
#there is only one record with mg/L, so we will exclude it because that is not a
#valid unit for solids

unique(data_wrangle_2$Sample_Depth_Unit)
#Some of the data has no, or inconsistent depth data, we will need to come up with an average depth value for further analysis

```

After cleaning the dataset, we plotted sample depths against mercury 
concentrations, mapped the sampling locations onto the Penobscot River, 
and examined concentration trends over time. We plotted a reference line 
representing the mercury PEC, above which harmful effects to sediment-dwelling 
biota are likely to occur.


```{r data.exploration.figures, warning=FALSE}

#Plot Depths and Concentration
ggplot(data_wrangle_2, aes(x=Date, y=Sample_Upper_Depth, fill=Max_Result_.Raw.)) +
  geom_point(shape=21) +
  scale_y_reverse() +
  labs(y="Depth (cm)", fill="Concentration (PPM)") 


#Map samples to Penobscot River
mapview(Penobscot) + mapview(data_wrangle_2, 
                                                   col.regions = "grey", 
                                                   alpha.regions = 0.5)

#Plot concentrations samples over time - gap between 1970 and mid 90s identified
ggplot(data_wrangle_2, aes(x=Date, y=Max_Result_.Raw.)) +
  geom_point() +
  labs(y="Concentration (PPM)",
       title = "Mercury Concentrations 1970-2021") +
  geom_hline(yintercept = 1.06, color = "red")
#this line represents the mercury PEC, above which harmful effects to sediment dwelling biota are likely to be observed.

```

A preliminary review revealed a major data gap between 1970 
and 2000, leaving insufficient information to conduct a long-term time-series 
analysis or evaluate the direct effects of the 1967 contamination event. 
This gap reflects broader historical issues in environmental monitoring and 
regulatory oversight during that period. To ensure analytical consistency, 
we restricted our final dataset to samples collected from 2000–2021.


## Data Wrangling 

Our initial exploration showed that some concentration results were coded as 
–9, NOAA’s indicator for missing data, so these records were excluded. 
We also identified two measurement units—PPM and mg/L—but because mg/L 
is not appropriate for solids and appeared in only one record, that 
entry was removed. Additionally, some samples had missing or inconsistent 
depth information, so an average depth value will need to be generated for 
further analysis.

```{r data.cleaning, warning=FALSE}
#filter data before 2000 and remove -9 in results and mg/L units
#also converting sample depths to feet
data_wrangle_3 <- data_wrangle_2 %>%
  mutate(Year=year(Date)) %>%
  filter(Year>(2000)) %>% 
  filter(Max_Result_.Raw. >= 0) %>% 
  filter(Analysis_Result_Unit == "PPM") %>% 
  mutate(Upper_Depth_ft = if_else(Sample_Upper_Depth >= 0, 
                                  Sample_Upper_Depth*0.0328084,
                                  Sample_Upper_Depth),
         Lower_Depth_ft = if_else(Sample_Lower_Depth >= 0,
                                  Sample_Lower_Depth*0.0328084,
                                  Sample_Lower_Depth),
         Avg_Depth_ft = if_else(Upper_Depth_ft >= 0 & Lower_Depth_ft >= 0,
                               (Upper_Depth_ft+Lower_Depth_ft)/2, -9))

#Intersect the samples with the Penobscot River to ensure we are only looking
#at samples in our area of interest.

data_clean <- data_wrangle_3 %>% 
  st_filter(Penobscot_clean) %>% 
  arrange(Max_Result_.Raw.)

#create a summary table

```

## Spatial Analysis

The analysis begins with orienting the viewers to the Penobscot 
River in Maine, in relation to mercury concentrations. The map was 
created using the shapefiles that were read in, and the subsequent spatial 
dataset subset during the original data wrangling. In the figures you can see 
that the highest concentrations are centered around the historical site itself.

Map 1 is a map of mercury concentration, in part per million (PPM) 
as a color gradient in the spatially situated river. As seen the highest
values are around 108.63 PPM, which is 100 times that of the PEC.

Map 2 is a zoomed in map of samples around the contamination site.

Map 3 is the spatial distribution of sample points.


```{r spatial.data}

Penobscot_Map = mapview(Penobscot_clean,
                        col.regions = "lightblue",
                        alpha.regions = 1,
                        map.types = "CartoDB.Positron",
                        legend = FALSE)

# Map of concentrations across the entire river
Concentration_Map = Penobscot_Map + mapview(data_clean, zcol = "Max_Result_.Raw.",
                                            alpha.regions = 0.5, 
                                            col.regions = colorRampPalette(c("yellow", 
                                                                            "orange", 
                                                                            "red")),
                                            layer.name = "Mercury Concentration (PPM)")


# Map of concentrations near the site
bbox <- st_as_sfc(st_bbox(c(xmin = -68.844, ymin = 44.734, xmax = -68.819,
                            ymax = 44.748), crs = 4269))

data_near_site <- data_clean %>% 
  st_filter(bbox)

Site_Map = mapview(data_near_site, zcol = "Max_Result_.Raw.",
                                            alpha.regions = 0.5, 
                                            col.regions = colorRampPalette(c("yellow", 
                                                                            "orange", 
                                                                            "red")),
                                            layer.name = "Mercury Concentration (PPM)",
                   map.types = "CartoDB.Positron") +
  mapview(Site, col.regions = "black", alpha.regions = 1)


 
```

We then ran a multiple linear regression to determine if either 
variable- time or depth, had an impact on mercury concentration in the river.

## Multiple linear regressions

```{r MLR.plopr}


#Multiple linear regression to see depth  and time

mercury_depthtime_regression <- lm(data=data_clean, 
                               Max_Result_.Raw.~Avg_Depth_ft+ Date)
summary (mercury_depthtime_regression)


```

This shows that at least one predictor is associated with concentration, 
but it is small. This sets the stage for the rest of our analysis.

## Temporal Relationship

This analysis starts with specific wrangling into a month colomn
to prepare the data for a time series analysis. Due to logistical and budget
constraints, it seems that data was not regularly collected, 
meaning there are some gaps in the samples collected each month.

```{r temporal}

#preliminary wrangle for analysis 

MonthlyData <- data_clean %>%
  mutate(Year = year(Date), Month = month(Date)) %>%
  group_by(Year, Month) %>%
  summarize(Mean_Conc = mean(Max_Result_.Raw., na.rm = TRUE), .groups = "drop")

MonthlyData_final <- MonthlyData %>%
  mutate(Date = ymd(paste0(Year, "-", Month, "-01"))) %>%
  select(Date, Mean_Conc)

#time plot

ggplot(MonthlyData_final,
        aes(x = Date, y = Mean_Conc)) +
  geom_line() +
  geom_smooth(method = "lm")+
  labs(
  title= "Mean Monthly Mercury Concentrations over Time (PPM)",
  x = "Date", 
  y = "Mean Monthly Mercury Concentrations (PPM)")+ 
Mytheme

#Linear model
mercury_time_regression <- lm(data=MonthlyData_final, 
                               Mean_Conc~Date)
summary (mercury_time_regression)

#Time Series Object

f_month <- month(first(data_clean$Date)) 
f_year  <- year(first(data_clean$Date))

MercuryMonthly.ts <- ts(MonthlyData_final$Mean_Conc,
                        start = c(min(f_year), 
                                  min(f_month)),
                        frequency = 12) 

#decomposition

MonthlyData_final_decomp <- stl(MercuryMonthly.ts,s.window = "periodic")
plot(MonthlyData_final_decomp, main = "Monthly Mercury Decomposition")

#MannKendallSeasonal

MonthlyMercury_Seasonal_Trend <- Kendall::SeasonalMannKendall(MercuryMonthly.ts)
summary(MonthlyMercury_Seasonal_Trend)

# MannKendallnotseasonal
Mercury_Seasonal_Component <- 
MonthlyData_final_decomp$time.series[, "seasonal"]

MonthlyMercury_noseason_ts <- MercuryMonthly.ts - Mercury_Seasonal_Component

Mercury_noseason_trend <- trend::mk.test(MonthlyMercury_noseason_ts)
summary(Mercury_noseason_trend)

```

We first plotted a graph of merucry concentrations as a function of time. We 
see an unexpected peak in 2021. Next, we ran a simple linear regression, 
and found a non statistically significant p-value.
Because we did not find a linear trend, so we ran the  seasonal Mann Kendall
test to determine whether there is a monotonic trend that fluctuates with 
seasonal patterns, we obtained a p-value of 0.596. This is not a 
significant p-value, indicating that there is no statistically significant
trend in the seasonal data. We then ran a non-seasonal trend test, which also 
produced a non-significant p-value. Together, these results show that there 
is no temporal trend in contamination levels in the Penobscot River. Therefore,
we must reject our first hypothesis in its entirety.

## Depth
How do Mercury levels change, based on depth? 

The following graph reflects the mercury concentrations from 1970 - 2021 by 
depth type (surface sediment or subsurface sediment). As seen in the graph, 
the 1970 has more surface sediment mercury concentrations which reflects 
the proximity to the initial pollution. Whereas later decades have more 
subsurface sediment mercury concentrations. 

```{r depth}

DepthPlot.data <- data_clean %>%
  na.omit() %>%
  filter(Avg_Depth_ft>=0)

#Plot of concentrations vs time by depth type.
Depthdata<-data_clean %>% 
  na.omit()

ggplot(Depthdata,
       aes(x=Date, 
           y=Max_Result_.Raw., 
           color = Depth_Category))+
    geom_point(alpha = 0.7) + 
  labs(
    title = "Mercury Concentration vs. Average Depth",
    x = "Date",
    y = "Mercury Concentration (PPM)") +
  Mytheme

#simple plot
ggplot(DepthPlot.data,
       aes(x = Avg_Depth_ft, y = Max_Result_.Raw.)) +
  geom_point(alpha = 0.7, color = "darkblue") + 
  labs(
    title = "Mercury Concentration vs. Average Depth",
    x = "Average Sample Depth (ft)",
    y = "Mercury Concentration (PPM)"
  ) +
  Mytheme

#top two feet because that is the most biologically active zone 
DepthPlot.data_bioactive <- DepthPlot.data %>% 
  filter(Avg_Depth_ft <= 2)

ggplot(DepthPlot.data_bioactive,
       aes(x = Avg_Depth_ft, y = Max_Result_.Raw.)) +
  geom_point(alpha = 0.7, color = "darkblue") + 
  labs(
    title = "Mercury Concentration vs. Average Depth",
    x = "Average Sample Depth (ft)",
    y = "Mercury Concentration (PPM)"
  ) +
  Mytheme


#Linear regression to see depth

mercury_depth_regression <- lm(data=DepthPlot.data, 
                               Max_Result_.Raw.~Avg_Depth_ft)
summary (mercury_depth_regression)

```

In our initial analysis of the first plot, we observed that subsurface sediment
generally showed higher mercury concentrations over time. In the next figure,
we found that mercury concentrations were primarily aggregated within the top 
0–2 feet of depth. Because this upper zone is the most biologically active, 
we created another plot isolating only the top two feet. Even after this
refinement, no significant temporal trend was detected.

To further assess the potential relationship between mercury concentration 
and depth, we conducted a linear regression analysis. Although the data did 
not visually suggest a trend, the regression results indicated evidence of a
linear relationship, as the p-value was statistically significant (p < 0.05). 
However, the adjusted R-squared value of 0.001936 showed that the relationship 
is extremely weak.

Therefore, although a statistically detectable linear 
relationship exists, depth cannot be considered a meaningful 
predictor of mercury concentration because the effect size is negligible. 
We must conclude that our results are inconclusive, meaning we cannot 
confidently determine whether our hypothesis is true or false.


## Conclusion
```{r conclusion}

#Spearman Rho because there is no seasonality, it is non-parametric and missing
#data is allowed.?

```
In conclusion, after conducting our temporal analysis, we found that we 
had to reject our first hypothesis that, post-closure of the site, mercury 
levels in surface sediment would decrease over time and with increasing 
distance from the source due to natural attenuation. We acknowledge that 
this outcome may be influenced by the large data gap in the NOAA dataset, 
which makes it difficult to analyze the years immediately following 
contamination. Despite this limitation, our spatial analysis showed that the 
highest mercury concentrations still remain closest to the original 
contamination site.

In our depth analysis, we also had to reject our second hypothesis. 
Although the regression produced a statistically significant p-value, 
the relationship was weak, limiting our confidence in the results. Incorporating 
additional data or more detailed sampling could potentially change these 
findings.

Next steps in this study would include continuing to collect and clean data, 
and possibly interpolating or otherwise manipulating the existing data points 
to create a more comprehensive temporal dataset. This would allow for a 
clearer understanding of long-term trends and improve the reliability of 
future analyses.

List of R squared values and p-values from linear regression.

| Variable  | R squared value |	P-value    | 
|----------:|:----------------|:-----------|
| Time      |      0.01026    | 0.2237     |
| Depth     |    0.001936     | 0.0001124  |




